<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>Upload.io 大文件上传</title>
  <style>
    body { padding: 20px; max-width: 600px; margin: 0 auto; font-family: Arial; }
    .upload-area { margin: 20px 0; padding: 20px; border: 2px dashed #ccc; text-align: center; }
    .result { margin: 20px 0; padding: 10px; border-radius: 5px; }
    .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
    .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
  </style>
  <!-- 引入 Upload.io SDK -->
  <script src="https://cdn.jsdelivr.net/npm/@upload-io/uploader@latest/dist/uploader.umd.min.js"></script>
</head>
<body>
  <h1>Upload.io 大文件上传</h1>
  
  <div class="upload-area">
    <h3>选择文件上传</h3>
    <input type="file" id="fileInput" accept="*/*">
    <button id="uploadBtn">上传</button>
    <div id="status"></div>
  </div>
  
  <div id="result" class="result" style="display: none;"></div>
  
  <script>
    // 初始化 Upload.io
    // 注意：你需要在 Upload.io 网站上注册并获取 API 密钥
    // 这里使用的是示例 API 密钥，实际使用时需要替换
    const uploader = new Uploader({
      apiKey: 'free' // 这是免费的示例 API 密钥
    });
    
    document.getElementById('uploadBtn').addEventListener('click', async () => {
      const fileInput = document.getElementById('fileInput');
      const file = fileInput.files[0];
      const statusDiv = document.getElementById('status');
      const resultDiv = document.getElementById('result');
      
      if (!file) {
        showResult('请选择文件！', 'error');
        return;
      }
      
      try {
        statusDiv.textContent = '上传中...';
        
        console.log(`开始上传: ${file.name} (${file.size} 字节)`);
        
        // 使用 Upload.io 上传文件
        // Upload.io 专门为大文件上传设计，支持分块上传和断点续传
        const fileUrl = await uploader.uploadFile(file, {
          onProgress: (progress) => {
            console.log(`上传进度: ${Math.round(progress * 100)}%`);
            statusDiv.textContent = `上传中... ${Math.round(progress * 100)}%`;
          }
        });
        
        console.log('上传成功:', fileUrl);
        
        showResult(`文件上传成功！<br>URL: ${fileUrl}`, 'success');
        statusDiv.textContent = '上传完成！';
        
      } catch (error) {
        console.error('上传失败:', error);
        showResult(`上传失败: ${error.message}`, 'error');
        statusDiv.textContent = '上传失败！';
      }
    });
    
    function showResult(message, type) {
      const resultDiv = document.getElementById('result');
      resultDiv.innerHTML = message;
      resultDiv.className = `result ${type}`;
      resultDiv.style.display = 'block';
    }
  </script>
</body>
</html>
